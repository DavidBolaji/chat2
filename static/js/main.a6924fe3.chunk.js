(this.webpackJsonpchat2=this.webpackJsonpchat2||[]).push([[0],{16:function(e,t,a){e.exports={"user-page":"Chat_user-page__3FIwI","user-page-header":"Chat_user-page-header__23bxC",box:"Chat_box__38oxW",user:"Chat_user__3I34e","sidebar-users__chat-area":"Chat_sidebar-users__chat-area__2Qzos","chat-msg":"Chat_chat-msg__1lESp",left:"Chat_left__2r4no","form-grp":"Chat_form-grp__2eN7b"}},23:function(e,t,a){e.exports={sidebar:"Sidebar_sidebar__1tCLh","sidebar-header":"Sidebar_sidebar-header__29D22","sidebar-users":"Sidebar_sidebar-users__1HQ5B",user:"Sidebar_user__32gb4"}},36:function(e,t,a){e.exports={container:"App_container__36SEG",app:"App_app__1C4dn"}},37:function(e,t,a){e.exports={user:"User_user__2qq8m",box:"User_box__1x_dz",msg:"User_msg__equPI"}},48:function(e,t,a){e.exports={login:"Login_login__VnYP9"}},83:function(e,t,a){"use strict";a.r(t);var c=a(0),s=a(10),n=a(27),r=a.n(n),i=a(6),o=a(36),u=a.n(o),l=a(21),d=a(4),j=a(23),b=a.n(j),m=function(e,t){var a={},c={};e.split("").forEach((function(e){a[e]||(a[e]=0),a[e]++})),t.split("").forEach((function(e){c[e]||(c[e]=0),c[e]++}));var s=Number(Object.values(a).sort().join(""))+Number(Object.values(c).sort().join(""));return String(s)},p=a(91),h=a(30),O=a.n(h);a(46);a(76);var f=Object(h.initializeApp)({apiKey:"AIzaSyC2DEhjn4vwD0M0P5Qy6aG070QhDQXTZCo",authDomain:"chat-clone-87936.firebaseapp.com",projectId:"chat-clone-87936",storageBucket:"chat-clone-87936.appspot.com",messagingSenderId:"521626344990",appId:"1:521626344990:web:f98e5b08a500d2eb58d80f",measurementId:"G-FKD7HB1K0G"}),g=O.a.auth(),x=new O.a.auth.GoogleAuthProvider,_=f.firestore(),v=a(37),S=a.n(v),I=a(2),N=function(e){e.id;var t=e.msg,a=e.src,c=e.lastmsg;e.onClick;return Object(I.jsx)(l.b,{to:"/users/".concat(t),children:Object(I.jsxs)("div",{className:S.a.user,children:[Object(I.jsx)(p.a,{src:a}),Object(I.jsxs)("div",{className:S.a.msg,children:[Object(I.jsx)("p",{children:t}),""!==c&&Object(I.jsx)("p",{children:c})]})]})})},y=function(e){var t=Object(c.useState)([]),a=Object(i.a)(t,2),n=a[0],r=a[1],o=Object(c.useState)({}),u=Object(i.a)(o,2),l=u[0],d=u[1],j=Object(s.c)((function(e){return e.user})),h=Object(s.c)((function(e){return e.lastMsg}));Object(c.useEffect)((function(){j&&(_.collection("users").doc(j.email).set({aid:j.id,email:j.email,name:j.name,pic:j.pic,lastmm:"",rId:""}),_.collection("users").onSnapshot((function(e){return r(e.docs.map((function(e){return{id:e.id,aid:e.data().aid,name:e.data().name,email:e.data().email,pic:e.data().pic,lastmm:e.data().lastmm,rId:e.data().rId}})))})))}),[j]),Object(c.useEffect)((function(){d(h)}),[h]);var O=n.filter((function(e){return j.email!==e.email})).map((function(e){var t,a=m(j.email,e.email);return t=l[a]?l[a]:e.lastmm&&e.rId===j.email?e.lastmm:"",Object(I.jsx)(N,{id:e.id,msg:e.email,src:e.pic,lastmsg:t},e.id)}));return Object(I.jsxs)("div",{className:b.a.sidebar,children:[Object(I.jsxs)("div",{className:b.a["sidebar-header"],children:[Object(I.jsx)(p.a,{src:j.pic}),Object(I.jsx)("div",{className:b.a.user,children:Object(I.jsx)("p",{children:j.email})})]}),Object(I.jsx)("div",{className:b.a["sidebar-users"],children:O})]})},C=a(20),E=a.n(C),w=a(47),D=a(5),L=a(29),M=a(8),k=a(16),G=a.n(k),A=a(40),P=Object(A.b)({name:"auth",initialState:{isLoggedIn:!1,user:{},lastMsg:{}},reducers:{login:function(e,t){e.isLoggedIn=!0,e.user=t.payload},addLastMsg:function(e,t){e.lastMsg=t.payload}}}),Q=Object(A.a)({reducer:P.reducer}),z=P.actions,B=Q,H=a(92),U=function(e){var t=Object(s.c)((function(e){return e.user})),a=Object(c.useRef)(),n=Object(d.f)().Email,r=Object(c.useState)(""),o=Object(i.a)(r,2),u=o[0],l=o[1],j=Object(c.useState)(""),b=Object(i.a)(j,2),h=b[0],O=b[1],f=Object(c.useState)([]),g=Object(i.a)(f,2),x=g[0],v=g[1],S=t.email,N=Object(s.b)();Object(c.useEffect)((function(){if(n){_.collection("users").doc(n).onSnapshot((function(e){l(e.data().email),O(e.data().pic)}));var e=m(n,S);_.collection("messages").doc(e).get().then((function(t){t.exists?_.collection("messages").doc(e).onSnapshot((function(e){if(!e.exists)return v([]);v(Object(M.a)(Object.values(e.data())))})):v([])}))}}),[n,S]);var y=function(){var e=Object(L.a)(E.a.mark((function e(c){var s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),s=m(n,S),_.collection("messages").doc(s).set(Object(D.a)({},(new Date).toLocaleString(),{sid:S,docId:s,rid:n,msg:a.current.value,timestamp:(new Date).getHours()+":"+(new Date).getMinutes()}),{merge:!0}),e.next=5,_.collection("messages").doc(s).onSnapshot((function(e){v(Object(M.a)(Object.values(e.data())))}));case 5:_.collection("lastMsg").doc(s).set(Object(D.a)({},s,a.current.value)),_.collection("lastMsg").onSnapshot((function(e){var t={},a=[],c=[];e.docs.map((function(e){a.push.apply(a,Object(M.a)(Object.keys(e.data()))),c.push.apply(c,Object(M.a)(Object.values(e.data())))}));for(var s=0;s<a.length;s++)t[a[s]]||(t[a[s]]=c[s]),t[a[s]]=c[s];N(z.addLastMsg(Object(w.a)({},t)))})),_.collection("users").doc(t.email).set({aid:t.id,email:t.email,name:t.name,pic:t.pic,lastmm:a.current.value,rId:n}),a.current.value="";case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsxs)("div",{className:G.a["user-page"],children:[Object(I.jsxs)("div",{className:G.a["user-page-header"],children:[Object(I.jsx)(p.a,{src:h}),Object(I.jsx)("div",{className:G.a.user,children:Object(I.jsx)("p",{children:u})})]}),Object(I.jsx)("div",{className:G.a["sidebar-users__chat-area"],children:x.map((function(e){return e.rid!==S?Object(I.jsxs)("div",{id:Object(H.a)(),className:"".concat(G.a["chat-msg"]," ").concat(G.a.left),children:[Object(I.jsx)("p",{children:e.msg}),Object(I.jsx)("span",{children:e.timestamp})]},Object(H.a)()):Object(I.jsxs)("div",{id:Object(H.a)(),className:"".concat(G.a["chat-msg"]),children:[Object(I.jsx)("p",{children:e.msg}),Object(I.jsx)("span",{children:e.timestamp})]},Object(H.a)())}))}),Object(I.jsx)("div",{className:G.a["form-grp"],children:Object(I.jsxs)("form",{onSubmit:y,children:[Object(I.jsx)("input",{type:"text",placeholder:"Enter Message",ref:a}),Object(I.jsx)("button",{type:"submit",children:"Go"})]})})]})},q=a(48),K=a.n(q),W=function(){var e=Object(s.b)(),t=function(){var t=Object(L.a)(E.a.mark((function t(){var a;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.signInWithPopup(x);case 3:(a=t.sent).user.emailVerified&&e(z.login({id:a.user.uid,name:a.user.displayName,email:a.user.email,pic:a.user.photoURL})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),alert("".concat(t.t0.message," please try again!!!"));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}();return Object(I.jsx)("div",{className:K.a.login,children:Object(I.jsx)("button",{onClick:t,children:"SiGN IN WITH GOOGLE"})})};var F=function(){var e=Object(s.c)((function(e){return e.isLoggedIn})),t=Object(c.useState)(!1),a=Object(i.a)(t,2),n=a[0],r=a[1];return Object(c.useEffect)((function(){r(e)}),[e]),Object(I.jsx)("div",{className:u.a.container,children:Object(I.jsx)("div",{className:u.a.app,children:n?Object(I.jsx)(l.a,{children:Object(I.jsxs)(d.c,{children:[Object(I.jsxs)(d.a,{path:"/users/:Email",children:[Object(I.jsx)(y,{}),Object(I.jsx)(U,{})]}),Object(I.jsx)(d.a,{path:"/",children:Object(I.jsx)(y,{})})]})}):Object(I.jsx)(W,{})})})};r.a.render(Object(I.jsx)(s.a,{store:B,children:Object(I.jsx)(F,{})}),document.getElementById("root"))}},[[83,1,2]]]);
//# sourceMappingURL=main.a6924fe3.chunk.js.map